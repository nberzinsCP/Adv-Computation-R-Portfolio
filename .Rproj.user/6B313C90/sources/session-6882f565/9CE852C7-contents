---
title: "Lab 2: Advanced Data Visualization"
author: "Gavin Martinez, Nils Berzins"
date: "2023-04-13"
output: html_document
---

##Lab 2: Advanced Data Visualization

###Part One: Identifying Bad Visualizations

1. While there are certainly issues with this image, do your best to tell the story of this graph in words. That is, what is this graph telling you? What do you think the authors meant to convey with it?

This graph is attempting to describe the various rates of vaccine skepticism (by % of people surveyed believing vaccines are safe) worldwide by looking at individual nations and stratifying them by region. It seems the authors wanted to convey the different distributions present across different regions of the world. 
2. List the variables that appear to be displayed in this visualization.

On the x-axis, there is the % of the country's population that believes vaccines are safe. On the y-axis, it appears to be the index of the country in that region with 1 being the smallest % of believing vaccines are safe. 

3. Now that you're versed in the grammar of graphics (ggplot), list the aesthetics used and which variables are specified for each.

* Aesthetics
  + x = % of those surveyed who believe that vaccines are safe 
  + y = Index of country
  + groups = Region
* Geometry
  + dot plot
  
4. What type of graph would you call this?
A stacked scatter plot, stratified by region?

5. List all of the problems or things you would improve about this graph.

* The stacking leads to the graph being too tall to fit in one screen.
* The height of each corresponding region is associate purely with the number of countries in that region
* The Europe/Former Soviet Union distinction bothers me. Being a proud Latvian, I'm disappointed to see that Wellcome Global Monitor is still identifying my proud country by its former oppressor. This form of categorization (however convenient for the analyst) is antiquated and insensitive to those who have since claimed their own independence from the Soviet Union. 
* There is no mention of what the verticality of the dots means, it is eventually inferrable to be the country index. 
* It would likely make sense to just separate each of these regions into their own separate graphs, then using some sort of graph stacking (maybe "patchwork") to illustrate them all on one page.

### Part Two: Broad Visualization Improvement 
#### Second Data Visualization Improvement
1. Select a data visualization in the report that you think could be improved. Be sure to cite both the page number and figure title. Do your best to tell the story of this graph in words. That is, what is this graph telling you? What do you think the authors meant to convey with it?

 *Chart 4.5: The combined view of how people feel about the benefits of science on a personal and country level, Page 84* 

This chart is describing the four analyzable outcomes between one's views on the extent to which science benefits society and on the extent to which sciecne benefits people normally. The four outcomes are: The Excluded, The Enthusiasts, Skeptics, and The Included. The authors are using proportionately sized circles within these four categorize to in attempt to visually describe which of these four opinions are more popular than the others.

2. List the variables that appear to be displayed in this visualization.

2 Categorical Variables: 

* Views on extent to which science benefits society (most, some, very few)
* Views on extent to which science benefits people normally (Yes, No, Don't Know, Refused) 

The results are then displayed as a percent of all of those surveyed. 

3. Now that you're versed in the grammar of graphics (ggplot), list the aesthetics used and which variables are specified for each.

* Aesthetics - "Y": Benefiting society, "X": Benefiting people

4. What type of graph would you call this?

This graph visually looks like a simple correlogram/bubble plot however represents density of the respondents who answered a certain way as opposed to correlative relationship between numeric variables. Functionally, the graph matches a treemap the most with the unsure/chose not to answer respondents removed. 

5. List all of the problems or things you would improve about this graph.

* The categories implied by the axis are not clear 
* The specialized naming scheme is confusing
* The survey questions and axis don't seem to mean the same thing
* Axis labels are not centered
* Key not center right

6. Improve the visualization above by either re-creating it with the issues you identified fixed OR by creating a new visualization that you believe tells the same story better.

```{r Load Libraries}
library(tidyverse)
library(leaflet)
library(here)
library(readxl)
library(tidygeocoder)
```

```{r Data Cleaning}
countries <- c("United States", "Egypt", "Morocco", "Lebanon", "Saudi Arabia", "Jordan", "Turkey", "Pakistan", "Indonesia", "Bangladesh", "United Kingdom", "France", "Germany", "Netherlands", "Belgium", "Spain", "Italy", "Poland", "Hungary", "Czech Republic", "Romania", "Sweden", "Greece", "Denmark", "Iran", "Singapore", "Japan", "China", "India", "Venezuela", "Brazil", "Mexico", "Nigeria", "Kenya", "Tanzania", "Israel", "Palestinian Territories", "Ghana", "Uganda", "Benin", "Madagascar", "Malawi", "South Africa", "Canada", "Australia", "Philippines", "Sri Lanka", "Vietnam", "Thailand", "Cambodia", "Laos", "Myanmar", "New Zealand", "Botswana", "Ethiopia", "Mali", "Mauritania", "Mozambique", "Niger", "Rwanda", "Senegal", "Zambia", "South Korea", "Taiwan", "Afghanistan", "Belarus", "Georgia", "Kazakhstan", "Kyrgyzstan", "Moldova", "Russia", "Ukraine", "Burkina Faso", "Cameroon", "Sierra Leone", "Zimbabwe", "Costa Rica", "Albania", "Algeria", "Argentina", "Armenia", "Austria", "Azerbaijan", "Bolivia", "Bosnia and Herzegovina", "Bulgaria", "Burundi", "Chad", "Chile", "Colombia", "Comoros", "Republic of Congo", "Croatia", "Cyprus", "Dominican Republic", "Ecuador", "El Salvador", "Estonia", "Finland", "Gabon", "Guatemala", "Guinea", "Haiti", "Honduras", "Iceland", "Iraq", "Ireland", "Ivory Coast", "Kuwait", "Latvia", "Liberia", "Libya", "Lithuania", "Luxembourg", "Macedonia", "Malaysia", "Malta", "Mauritius", "Mongolia", "Montenegro", "Namibia", "Nepal", "Nicaragua", "Norway", "Panama", "Paraguay", "Peru", "Portugal", "Serbia", "Slovakia", "Slovenia", "Eswatini", "Switzerland", "Tajikistan", "The Gambia", "Togo", "Tunisia", "Turkmenistan", "United Arab Emirates", "Uruguay", "Uzbekistan", "Yemen", "Kosovo", "Northern Cyprus") #Chat GPT took the list from excel and made it a comma separated list, all hail Chat GPT

data_og <- read_xlsx("wgm_data2018.xlsx", sheet = 2) #renamed data set in my files

#Question 1: In general, do you think the work that scientists do benefits most, some, or very few people in this country?
#Question 2: In general, do you think the work that scientists do benefits people like you in this country?

data_clean <- data_og |> #Changing the Q1 and Q2 values
  select(WP5, Q16, Q17) |>
  mutate(Q16 = case_when(
    Q16 == 1 ~ "Most",
    Q16 == 2 ~ "Some",
    Q16 == 3 ~ "Very Few",
    Q16 == 98 ~ "DK",
    Q16 == 99 ~ "R")
    ) |>
  mutate(Q17 = case_when(
    Q17 == 1 ~ "Yes",
    Q17 == 2 ~ "No",
    Q17 == 98 ~ "DK",
    Q17 == 99 ~ "R")
    ) |>
  filter(Q16 %in% c("Most", "Some", "Very Few"),
         Q17 %in% c("Yes", "No")) |>
  rename("Country" = WP5, "Q1" = Q16, "Q2" = Q17) |>
  mutate(`Country` = countries[`Country`])

data_clean <- data_clean |> #importing country names and adding the combo column, case_when() wasn't working, sorry for ifelse spam
  mutate (Combo = ifelse(`Q1` %in% "Most" & `Q2` %in% "Yes", "Benefits Them & Most", NA),
          Combo = ifelse(`Q1` %in% "Very Few" & `Q2` %in% "Yes", "Benefits Them But Not Most", Combo),
          Combo = ifelse((`Q1` %in% "Some" | `Q1` %in% "Most") & `Q2` %in% "No", "Doesn't Benefit Them But Benefits Most", Combo),
          Combo = ifelse(`Q1` %in% "Very Few" & `Q2` %in% "No", "Doesn't Benefit Them Nor Most", Combo)) |>
  na.omit()
```

```{r Applying Geocode to each country}
data_clean_geo <- data_clean |> #Getting Geocode data for each country
  geocode(country = `Country`)
```

```{r Leaflet Map}
leaflet() |>
  addTiles() |>
  addCircles(lng = data_clean$long, 
             lat = data_clean$lat, 
             radius = length(data_clean$Combo[data_clean$Combo %in% "Benefits Them & Most"]),
             popup = data_clean$Combo[data_clean$Combo %in% "Benefits Them & Most"], 
             color = "#FFCD27", 
             opacity = .5) |>
  addCircles(lng = data_clean$long, 
             lat = data_clean$lat, 
             radius = length(data_clean$Combo[data_clean$Combo %in% "Benefits Them But Not Most"]),
             popup = data_clean$Combo[data_clean$Combo %in% "Benefits Them But Not Most"], 
             color = "#61933F", 
             opacity = .5) |>
  addCircles(lng = data_clean$long, 
             lat = data_clean$lat, 
             radius = length(data_clean$Combo[data_clean$Combo %in% "Doesn't Benefit Them But Benefits Most"]),
             popup = data_clean$Combo[data_clean$Combo %in% "Doesn't Benefit Them But Benefits Most"], 
             color = "#2FC1D2",
             opacity = .5) |>
  addCircles(lng = data_clean$long, 
             lat = data_clean$lat, 
             radius = length(data_clean$Combo[data_clean$Combo %in% "Doesn't Benefit Them Nor Most"]) ,
             popup = data_clean$Combo[data_clean$Combo %in% "Doesn't Benefit Them Nor Most"], 
             color = "#003D57", 
             opacity = .5) |>
  addLegend(position = "topright", title = "The combined view of how people feel about the benefits
of science on a personal and country level per country", labels = c("Benefits Them & Most", "Benefits Them But Not Most", "Doesn't Benefit Them But Benefits Most", "Doesn't Benefit Them Nor Most"), colors = c("#FFCD27", "#61933F", "#2FC1D2", "#003D57"))


```
